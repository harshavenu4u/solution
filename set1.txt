1)select * from(select e_id,name,salary,dense_rank() over (order by salary desc) as sal from employee)as A where sal<=3;
2)select * from(select e_id,name,salary,dense_rank() over (order by salary ) as sal from employee)as A where sal=1;
3) select * from employee where man_id not in (select emp_id from employee e join dep d on e.employee_name = d.dept_manager);
4) select distinct e1.name from employee e1 join employee e2 on e2.managerid=e1.e_id;
5.1)select *from employee where salary=(select min(salary) from emp where emp_id in(select man_id from emp));
6)select count(emp_id) from employee where dept_id in (select dept_id from dept where dept_name="comm");
7) select * from employee where (dept_id,salary) in (select d.dept_id,max(salary) from employee e join dep d on e.dept_id=d.dept_id  where dept_name="finance");
8) select * from employee where (dept_id,salary) in (select d.dept_id,min(salary) from employee e join dep d on e.dept_id=d.dept_id  where dept_name="product");
9) select count(*) from employee where salary=(select max(salary) from employee where dept_id='D01');
10)select * from employee where man_id = (select emp_id from emp where emp_name="Natasha Stevens");
11) select e.name,count(*),d.dept_name,d.dept_manager from employee e inner join dept d where d.dept_id='D01'and e.dept_id=d.dept_id;
12)select emp_id,man_id,dept_id from employee where dept_id =(select dept_id from dep where dept_name="comm");
13)select e.dept_id,avg(salary),d.dept_name from employee e join dep d on e.dept_id=d.dept_id group by dept_id;
14)select sum(salary) as total_expenses from employee where dept_id in(select dept_id from dep where dept_name='FINANCE');
15)select d.dept_id,d.dept_manager,count(*) from employee e join dep d on e.dept_id=d.dept_id group by d.dept_id having count(*) =(select min(member) from (select dept_id,count(*) as member from emp group by dept_id) as count_emp);
16)select count(e.e_id)as total_employees,d.depname from employee as e inner join dept as d on e.dep_id=d.dep_id group by d.depname;
17)select count(e.e_id)as total_employees,d.depname from employee as e inner join dept as d on e.dep_id=d.dep_id where salary< 10000 group by d.depname;
18)select count(emp_id) as count from employee where dept_id='D04';
19)select e.dept_id,d.dept_name,d.dept_manager,count(*) from employee e join dep d on e.dept_id=d.dept_id group by d.dept_id having count(*) =(select max(member) from (select dept_id,count(*) as member from emp group by dept_id) as count_emp);
20)select emp_id,emp_name from employee where man_id in (select emp_id from emp where emp_name="TIM COOK");
20.select e1.name,e2.name as m_name from employee as e1 inner join employee as e2 on e1.managerid=e2.e_id where e2.name='Tim Cook'  ;